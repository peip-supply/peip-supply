version: 2
jobs:
  apt:
    docker:
      - image: debian:stretch
    steps:
      - checkout
      - run:
          name: Setup
          command: |
            ./pkg-install.sh setup
            ./pkg-install.sh curl
            ./pkg-install.sh unzip
            tests/setup.sh
      - run:
          name: Tests
          command: |
             echo Running unit tests
             tests/unit/helpers/suite.sh
             echo Running integration tests
             tests/integration/apt/suite.sh
  apk:
    docker:
      - image: alpine
    steps:
      - checkout
      - run:
          name: Setup
          command: |
            scripts/setup/apk/install.sh
            apk add curl
            apk add unzip
            tests/setup.sh
      - run:
          name: Tests
          command: |
             echo Running integration tests
             tests/integration/apk/suite.sh
workflows:
  version: 2
  build_and_test:
    jobs:
      - apt
      - apk
